<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>数据挖掘实战01-居民收入分类 模型训练 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="降维连续数据12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010">
<meta property="og:type" content="article">
<meta property="og:title" content="数据挖掘实战01-居民收入分类 模型训练">
<meta property="og:url" content="http://yoursite.com/2019/07/27/数据挖掘实战01-居民收入分类-模型训练/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="降维连续数据12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-27T03:13:28.623Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="数据挖掘实战01-居民收入分类 模型训练">
<meta name="twitter:description" content="降维连续数据12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-数据挖掘实战01-居民收入分类-模型训练" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/27/数据挖掘实战01-居民收入分类-模型训练/" class="article-date">
  <time datetime="2019-07-27T03:09:48.000Z" itemprop="datePublished">2019-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      数据挖掘实战01-居民收入分类 模型训练
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="降维连续数据"><a href="#降维连续数据" class="headerlink" title="降维连续数据"></a>降维连续数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并训练集合与测试集合</span></span><br><span class="line"><span class="comment"># 1. 读取数据</span></span><br><span class="line">headers = [</span><br><span class="line">    <span class="string">'age'</span>, </span><br><span class="line">    <span class="string">'workclass'</span>, </span><br><span class="line">    <span class="string">'fnlwgt'</span>, </span><br><span class="line">    <span class="string">'education'</span>, </span><br><span class="line">    <span class="string">'education-num'</span>, </span><br><span class="line">    <span class="string">'marital-status'</span>, </span><br><span class="line">    <span class="string">'occupation'</span>, </span><br><span class="line">    <span class="string">'relation'</span>, </span><br><span class="line">    <span class="string">'race'</span>, </span><br><span class="line">    <span class="string">'sex'</span>, </span><br><span class="line">    <span class="string">'capital-gain'</span>, </span><br><span class="line">    <span class="string">'capital-loss'</span>, </span><br><span class="line">    <span class="string">'hours-per-week'</span>, </span><br><span class="line">    <span class="string">'native-country'</span>,</span><br><span class="line">    <span class="string">'predcalss'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 2.合并数据</span></span><br><span class="line">train_raw = pd.read_csv(</span><br><span class="line">    <span class="string">'adult.data'</span>,</span><br><span class="line">    header=<span class="literal">None</span>,</span><br><span class="line">    names=headers,</span><br><span class="line">    sep=<span class="string">',\s'</span>,</span><br><span class="line">    na_values=<span class="string">'?'</span>,</span><br><span class="line">    engine=<span class="string">'python'</span>,</span><br><span class="line">    skiprows=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line">test_raw = pd.read_csv(</span><br><span class="line">    <span class="string">'adult.test'</span>,</span><br><span class="line">    header=<span class="literal">None</span>,</span><br><span class="line">    names=headers,</span><br><span class="line">    sep=<span class="string">',\s'</span>,</span><br><span class="line">    engine=<span class="string">'python'</span>,</span><br><span class="line">    na_values=<span class="string">'?'</span>,</span><br><span class="line">    skiprows=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line">print(<span class="string">'数据加载完毕'</span>)</span><br><span class="line">dataset_raw = train_raw.append(test_raw)</span><br><span class="line"><span class="comment"># 3. 合并的数据集重新索引</span></span><br><span class="line"><span class="comment"># 重新索引</span></span><br><span class="line">dataset_raw.reset_index(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 删除索引</span></span><br><span class="line">dataset_raw.drop(<span class="string">'index'</span>, axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">print(<span class="string">'merge over'</span>)</span><br><span class="line">data_bin = pd.DataFrame()  <span class="comment"># 处理特征后的数据集（离散数据集）</span></span><br><span class="line">data_con = pd.DataFrame() <span class="comment"># 连续数据集</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理标签特征</span></span><br><span class="line"><span class="comment">#    - &gt;50k, 1</span></span><br><span class="line"><span class="comment">#    - &lt;=50,  0</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'predcalss'</span>] == <span class="string">'&gt;50K'</span>, <span class="string">'predcalss'</span> ] = <span class="number">1</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'predcalss'</span>] == <span class="string">'&lt;=50K'</span>, <span class="string">'predcalss'</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'predcalss'</span>] == <span class="string">'&gt;50K.'</span>, <span class="string">'predcalss'</span>] = <span class="number">1</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'predcalss'</span>] == <span class="string">'&lt;=50K.'</span>, <span class="string">'predcalss'</span> ] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理好的特征拷贝到处理好后缓冲</span></span><br><span class="line">data_bin[<span class="string">'predcalss'</span>] = dataset_raw[<span class="string">'predcalss'</span>]</span><br><span class="line">data_con[<span class="string">'predcalss'</span>] = dataset_raw[<span class="string">'predcalss'</span>]</span><br><span class="line">print(<span class="string">'feature label over'</span>)</span><br><span class="line"><span class="comment"># age的特征处理，1.连续性数据，不处理，2.离散化处理：年龄分成不同的年龄段</span></span><br><span class="line">data_con[<span class="string">'age'</span>] = dataset_raw[<span class="string">'age'</span>]   <span class="comment"># conitnue</span></span><br><span class="line">data_bin[<span class="string">'age'</span>] = pd.cut(dataset_raw[<span class="string">'age'</span>], <span class="number">10</span>)   <span class="comment"># bin</span></span><br><span class="line">print(<span class="string">'feature age over'</span>)</span><br><span class="line"><span class="comment"># 工作岗位的分类重新合并</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Without-pay'</span>,<span class="string">'workclass'</span>] = <span class="string">'Not Working'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Never-worked'</span>,<span class="string">'workclass'</span>] = <span class="string">'Not Working'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Federal-gov'</span>,<span class="string">'workclass'</span>]  = <span class="string">'Fed-gov'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'State-gov'</span>,<span class="string">'workclass'</span>]  = <span class="string">'Non-Fed-gov'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Local-gov'</span>,<span class="string">'workclass'</span>]  = <span class="string">'Non-Fed-gov'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Self-emp-not-inc'</span>,<span class="string">'workclass'</span>] = <span class="string">'Self-emp'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'workclass'</span>]==<span class="string">'Self-emp-inc'</span>,<span class="string">'workclass'</span>]  = <span class="string">'Self-emp'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拷贝到训练缓冲</span></span><br><span class="line">data_bin[<span class="string">'workclass'</span>] = dataset_raw[<span class="string">'workclass'</span>]</span><br><span class="line">data_con[<span class="string">'workclass'</span>] = dataset_raw[<span class="string">'workclass'</span>]</span><br><span class="line">print(<span class="string">'feature workclass over'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对职业进行合并</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Adm-clerical'</span>, <span class="string">'occupation'</span>] = <span class="string">'Admin'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Armed-Forces'</span>, <span class="string">'occupation'</span>] = <span class="string">'Military'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Craft-repair'</span>, <span class="string">'occupation'</span>] = <span class="string">'Manual Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Exec-managerial'</span>, <span class="string">'occupation'</span>] = <span class="string">'Office Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Farming-fishing'</span>, <span class="string">'occupation'</span>] = <span class="string">'Manual Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Handlers-cleaners'</span>, <span class="string">'occupation'</span>] = <span class="string">'Manual Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Machine-op-inspct'</span>, <span class="string">'occupation'</span>] = <span class="string">'Manual Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Other-service'</span>, <span class="string">'occupation'</span>] = <span class="string">'Service'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Priv-house-serv'</span>, <span class="string">'occupation'</span>] = <span class="string">'Service'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Prof-specialty'</span>, <span class="string">'occupation'</span>] = <span class="string">'Professional'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Protective-serv'</span>, <span class="string">'occupation'</span>] = <span class="string">'Military'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Sales'</span>, <span class="string">'occupation'</span>] = <span class="string">'Office Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Tech-support'</span>, <span class="string">'occupation'</span>] = <span class="string">'Office Labour'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'occupation'</span>]==<span class="string">'Transport-moving'</span>, <span class="string">'occupation'</span>] = <span class="string">'Manual Labour'</span></span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'occupation'</span>] = dataset_raw[<span class="string">'occupation'</span>]</span><br><span class="line">data_con[<span class="string">'occupation'</span>] = dataset_raw[<span class="string">'occupation'</span>]</span><br><span class="line">print(<span class="string">'feature occupation over'</span>)</span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Cambodia'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'SE-Asia'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Canada'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'British-Commonwealth'</span>    </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'China'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'China'</span>       </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Columbia'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span>    </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Cuba'</span>                        , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span>        </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Dominican-Republic'</span>          , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Ecuador'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span>     </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'El-Salvador'</span>                 , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span> </span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'England'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'British-Commonwealth'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'France'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_1'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Germany'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_1'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Greece'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Guatemala'</span>                   , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Haiti'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Holand-Netherlands'</span>          , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_1'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Honduras'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Hong'</span>                        , <span class="string">'native-country'</span>] = <span class="string">'China'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Hungary'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'India'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'British-Commonwealth'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Iran'</span>                        , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Ireland'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'British-Commonwealth'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Italy'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_1'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Jamaica'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Japan'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'APAC'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Laos'</span>                        , <span class="string">'native-country'</span>] = <span class="string">'SE-Asia'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Mexico'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Nicaragua'</span>                   , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Outlying-US(Guam-USVI-etc)'</span>  , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Peru'</span>                        , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Philippines'</span>                 , <span class="string">'native-country'</span>] = <span class="string">'SE-Asia'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Poland'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Portugal'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Puerto-Rico'</span>                 , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Scotland'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'British-Commonwealth'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'South'</span>                       , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Taiwan'</span>                      , <span class="string">'native-country'</span>] = <span class="string">'China'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Thailand'</span>                    , <span class="string">'native-country'</span>] = <span class="string">'SE-Asia'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Trinadad&amp;Tobago'</span>             , <span class="string">'native-country'</span>] = <span class="string">'South-America'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'United-States'</span>               , <span class="string">'native-country'</span>] = <span class="string">'United-States'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Vietnam'</span>                     , <span class="string">'native-country'</span>] = <span class="string">'SE-Asia'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'native-country'</span>] == <span class="string">'Yugoslavia'</span>                  , <span class="string">'native-country'</span>] = <span class="string">'Euro_Group_2'</span></span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'native-country'</span>] = dataset_raw[<span class="string">'native-country'</span>]</span><br><span class="line">data_con[<span class="string">'native-country'</span>] = dataset_raw[<span class="string">'native-country'</span>]</span><br><span class="line">print(<span class="string">'feature counyrt over'</span>)</span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'10th'</span>          , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'11th'</span>          , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'12th'</span>          , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'1st-4th'</span>       , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'5th-6th'</span>       , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'7th-8th'</span>       , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'9th'</span>           , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Assoc-acdm'</span>    , <span class="string">'education'</span>] = <span class="string">'Associate'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Assoc-voc'</span>     , <span class="string">'education'</span>] = <span class="string">'Associate'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Bachelors'</span>     , <span class="string">'education'</span>] = <span class="string">'Bachelors'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Doctorate'</span>     , <span class="string">'education'</span>] = <span class="string">'Doctorate'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'HS-Grad'</span>       , <span class="string">'education'</span>] = <span class="string">'HS-Graduate'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Masters'</span>       , <span class="string">'education'</span>] = <span class="string">'Masters'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Preschool'</span>     , <span class="string">'education'</span>] = <span class="string">'Dropout'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Prof-school'</span>   , <span class="string">'education'</span>] = <span class="string">'Professor'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'education'</span>] == <span class="string">'Some-college'</span>  , <span class="string">'education'</span>] = <span class="string">'HS-Graduate'</span></span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'education'</span>] = dataset_raw[<span class="string">'education'</span>]</span><br><span class="line">data_con[<span class="string">'education'</span>] = dataset_raw[<span class="string">'education'</span>]</span><br><span class="line">print(<span class="string">'feature edu over'</span>)</span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Never-married'</span>        , <span class="string">'marital-status'</span>] = <span class="string">'Never-Married'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Married-AF-spouse'</span>    , <span class="string">'marital-status'</span>] = <span class="string">'Married'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Married-civ-spouse'</span>   , <span class="string">'marital-status'</span>] = <span class="string">'Married'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Married-spouse-absent'</span>, <span class="string">'marital-status'</span>] = <span class="string">'Not-Married'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Separated'</span>            , <span class="string">'marital-status'</span>] = <span class="string">'Separated'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Divorced'</span>             , <span class="string">'marital-status'</span>] = <span class="string">'Separated'</span></span><br><span class="line">dataset_raw.loc[dataset_raw[<span class="string">'marital-status'</span>] == <span class="string">'Widowed'</span>              , <span class="string">'marital-status'</span>] = <span class="string">'Widowed'</span></span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'marital-status'</span>] = dataset_raw[<span class="string">'marital-status'</span>]</span><br><span class="line">data_con[<span class="string">'marital-status'</span>] = dataset_raw[<span class="string">'marital-status'</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">'feature status over'</span>)</span><br><span class="line"><span class="comment"># fnlw:final weight:序号</span></span><br><span class="line"><span class="comment"># 离散：连续</span></span><br><span class="line">data_bin[<span class="string">'fnlwgt'</span>] = pd.cut(dataset_raw[<span class="string">'fnlwgt'</span>], <span class="number">10</span>)</span><br><span class="line">data_con[<span class="string">'fnlwgt'</span>] = dataset_raw[<span class="string">'fnlwgt'</span>]</span><br><span class="line">print(<span class="string">'feature fntwgt over'</span>)</span><br><span class="line"><span class="comment"># education-num ：连续，离散</span></span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'education-num'</span>] = pd.cut(dataset_raw[<span class="string">'education-num'</span>], <span class="number">10</span>)</span><br><span class="line">data_con[<span class="string">'education-num'</span>] = dataset_raw[<span class="string">'education-num'</span>]</span><br><span class="line">print(<span class="string">'feature edu-num over'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hours-per-week</span></span><br><span class="line">data_bin[<span class="string">'hours-per-week'</span>] = pd.cut(dataset_raw[<span class="string">'hours-per-week'</span>], <span class="number">10</span>)</span><br><span class="line">data_con[<span class="string">'hours-per-week'</span>] = dataset_raw[<span class="string">'hours-per-week'</span>]</span><br><span class="line">print(<span class="string">'feature hours over'</span>)</span><br><span class="line"><span class="comment"># capital-gain</span></span><br><span class="line">data_bin[<span class="string">'capital-gain'</span>] = pd.cut(dataset_raw[<span class="string">'capital-gain'</span>], <span class="number">10</span>)</span><br><span class="line">data_con[<span class="string">'capital-gain'</span>] = dataset_raw[<span class="string">'capital-gain'</span>]</span><br><span class="line">print(<span class="string">'feature gain over'</span>)</span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'capital-loss'</span>] = pd.cut(dataset_raw[<span class="string">'capital-loss'</span>], <span class="number">10</span>)</span><br><span class="line">data_con[<span class="string">'capital-loss'</span>] = dataset_raw[<span class="string">'capital-loss'</span>]</span><br><span class="line">print(<span class="string">'feature losss over'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># race ,sex, relationship</span></span><br><span class="line">data_bin[<span class="string">'race'</span>] = data_con[<span class="string">'race'</span>] = dataset_raw[<span class="string">'race'</span>]</span><br><span class="line">data_bin[<span class="string">'sex'</span>] = data_con[<span class="string">'sex'</span>] = dataset_raw[<span class="string">'sex'</span>]</span><br><span class="line">data_bin[<span class="string">'relation'</span>] = data_con[<span class="string">'relation'</span>] = dataset_raw[<span class="string">'relation'</span>]</span><br><span class="line">print(<span class="string">'feature race sex rel over'</span>)</span><br><span class="line"><span class="comment"># age + hour-per-week</span></span><br><span class="line">data_con[<span class="string">'age-hours'</span>] = data_con[<span class="string">'age'</span>] * data_con[<span class="string">'hours-per-week'</span>]</span><br><span class="line"></span><br><span class="line">data_bin[<span class="string">'age-hours'</span>] = pd.cut(data_con[<span class="string">'age-hours'</span>], <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sex + married</span></span><br><span class="line">data_bin[<span class="string">'sex-marital'</span>] = data_con[<span class="string">'sex-marital'</span>] = data_con[<span class="string">'sex'</span>] + data_con[<span class="string">'marital-status'</span>]</span><br><span class="line">print(<span class="string">'feature creation  over'</span>)</span><br><span class="line"><span class="comment"># 确定编码的字段</span></span><br><span class="line">one_hot_cols = data_bin.columns.tolist()</span><br><span class="line"><span class="comment"># 标签的字段不需要编码</span></span><br><span class="line">one_hot_cols.remove(<span class="string">'predcalss'</span>)</span><br><span class="line"></span><br><span class="line">data_bin_encode = pd.get_dummies(data_bin, columns=one_hot_cols)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连续的特征处理</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">encoder = LabelEncoder()</span><br><span class="line"><span class="comment"># 转换数据类型</span></span><br><span class="line">data_con = data_con.astype(<span class="string">'str'</span>)</span><br><span class="line"><span class="comment"># 编码转换</span></span><br><span class="line">data_con_encode = data_con.apply(encoder.fit_transform)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'encode over'</span>)</span><br><span class="line"><span class="comment"># 数据差分成训练数据，测试数据集。</span></span><br><span class="line"></span><br><span class="line">train = data_con_encode.loc[<span class="number">0</span>:<span class="number">32560</span>,:]</span><br><span class="line">test = data_con_encode.loc[<span class="number">32560</span>:, :]</span><br><span class="line"></span><br><span class="line">train = train.dropna(axis=<span class="number">0</span>)</span><br><span class="line">test= test.dropna(axis=<span class="number">0</span>)</span><br><span class="line">print(<span class="string">'dataset split over'</span>)</span><br><span class="line"><span class="comment"># --------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备数据集</span></span><br><span class="line">X_train = train.drop(<span class="string">'predcalss'</span>,axis=<span class="number">1</span>)</span><br><span class="line">Y_train =train[<span class="string">'predcalss'</span>].astype(<span class="string">'int64'</span>)  <span class="comment"># 转换为数值型</span></span><br><span class="line"></span><br><span class="line">X_test = test.drop(<span class="string">'predcalss'</span>,axis=<span class="number">1</span>)</span><br><span class="line">Y_test =test[<span class="string">'predcalss'</span>].astype(<span class="string">'int64'</span>)  <span class="comment"># 转换为数值型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 降维</span></span><br><span class="line"><span class="comment"># 创建缩放器</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="comment"># 训练缩放参数（使用训练数据集）</span></span><br><span class="line">std_scaler = StandardScaler()</span><br><span class="line">std_scaler.fit(X_train)</span><br><span class="line"><span class="comment"># 产生归一化数据</span></span><br><span class="line">X_train = std_scaler.transform(X_train)</span><br><span class="line">X_test = std_scaler.transform(X_test)</span><br><span class="line">print(<span class="string">'归一化结束'</span>)</span><br><span class="line"><span class="comment"># PCA降维对象</span></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">pca=PCA(n_components=<span class="number">10</span>) <span class="comment">#维度=10(1-219)</span></span><br><span class="line"><span class="comment"># 训练降维参数（奇异值分解）</span></span><br><span class="line">pca.fit(X_train)</span><br><span class="line"><span class="comment"># 降维</span></span><br><span class="line">X_train=pca.transform(X_train)</span><br><span class="line">X_test=pca.transform(X_test)</span><br><span class="line">print(<span class="string">'decomposition over'</span>)</span><br><span class="line"><span class="comment">#---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># ---------------------------------------------</span></span><br><span class="line"><span class="comment"># 逻辑回归</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line">lr_classifier = LogisticRegression(solver=<span class="string">'lbfgs'</span>,C=<span class="number">1.0</span>, max_iter=<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">lr_classifier.fit(X_train,Y_train)</span><br><span class="line">train_score = lr_classifier.score(X_train,Y_train)</span><br><span class="line">test_score = lr_classifier.score(X_test,Y_test)</span><br><span class="line">end = time.time()</span><br><span class="line">print(F<span class="string">"训练集准确率：&#123;train_score*100:8.2f&#125;%，测试集准确率：&#123;test_score*100:8.2f&#125;%，Time:&#123;end-start&#125;s"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------</span></span><br><span class="line"><span class="comment"># k近邻算法</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"></span><br><span class="line">knn_classifier = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">knn_classifier.fit(X_train,Y_train)</span><br><span class="line">train_score = knn_classifier.score(X_train,Y_train)</span><br><span class="line">test_score = knn_classifier.score(X_test,Y_test)</span><br><span class="line">end = time.time()</span><br><span class="line">print(F<span class="string">"训练集准确率：&#123;train_score*100:8.2f&#125;%，测试集准确率：&#123;test_score*100:8.2f&#125;%，Time:&#123;end-start&#125;s"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 朴素贝叶斯分类</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB, BernoulliNB, MultinomialNB</span><br><span class="line">gau_classifier = GaussianNB()</span><br><span class="line"></span><br><span class="line">gau_classifier.fit(X_train,Y_train)</span><br><span class="line">train_score = gau_classifier.score(X_train,Y_train)</span><br><span class="line">test_score = gau_classifier.score(X_test,Y_test)</span><br><span class="line">end = time.time()</span><br><span class="line">print(F<span class="string">"训练集准确率：&#123;train_score*100:8.2f&#125;%，测试集准确率：&#123;test_score*100:8.2f&#125;%，Time:&#123;end-start&#125;s"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line"><span class="comment"># 支持向量机</span></span><br><span class="line">start = time.time()</span><br><span class="line">classifier = SVC(gamma=<span class="string">'auto'</span>,kernel=<span class="string">'linear'</span>,C=<span class="number">1.0</span>)</span><br><span class="line">classifier.fit(X_train, Y_train)</span><br><span class="line"></span><br><span class="line">train_score = classifier.score(X_train,Y_train)</span><br><span class="line">test_score = classifier.score(X_test,Y_test)</span><br><span class="line">end = time.time()</span><br><span class="line">print(F<span class="string">"训练集准确率：&#123;train_score*100:8.2f&#125;%，测试集准确率：&#123;test_score*100:8.2f&#125;%，Time:&#123;end-start&#125;s"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------</span></span><br><span class="line"><span class="comment"># 随机森林</span></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br><span class="line">rf_classifier = RandomForestClassifier(n_estimators=<span class="number">100</span>)</span><br><span class="line">rf_classifier.fit(X_train,Y_train)</span><br><span class="line"></span><br><span class="line">train_score = rf_classifier.score(X_train,Y_train)</span><br><span class="line">test_score = rf_classifier.score(X_test,Y_test)</span><br><span class="line">end = time.time()</span><br><span class="line">print(F<span class="string">"训练集准确率：&#123;train_score*100:8.2f&#125;%，测试集准确率：&#123;test_score*100:8.2f&#125;%，Time:&#123;end-start&#125;s"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==========================================</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先计算预测</span></span><br><span class="line"></span><br><span class="line">pre_lr = lr_classifier.predict(X_test)</span><br><span class="line">report_lr = classification_report(Y_test, pre_lr)</span><br><span class="line">print(report_lr)</span><br><span class="line"></span><br><span class="line">pre_knn = knn_classifier.predict(X_test)</span><br><span class="line">report_knn = classification_report(Y_test, pre_knn)</span><br><span class="line">print(report_knn)</span><br><span class="line"></span><br><span class="line">pre_gau = gau_classifier.predict(X_test)</span><br><span class="line">report_gau = classification_report(Y_test, pre_gau)</span><br><span class="line">print(report_gau)</span><br><span class="line"></span><br><span class="line">pre = classifier.predict(X_test)</span><br><span class="line">report = classification_report(Y_test, pre)</span><br><span class="line">print(report)</span><br><span class="line"></span><br><span class="line">pre_rf = rf_classifier.predict(X_test)</span><br><span class="line">report_rf = classification_report(Y_test, pre_rf)</span><br><span class="line">print(report_rf)</span><br></pre></td></tr></table></figure>

<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><pre><code>训练集准确率：   79.83%，测试集准确率：   80.01%，Time:0.04191875457763672s
训练集准确率：   89.65%，测试集准确率：   81.01%，Time:4.517231225967407s
训练集准确率：   77.47%，测试集准确率：   77.74%，Time:0.04989743232727051s
训练集准确率：   79.01%，测试集准确率：   79.33%，Time:36.958059549331665s
训练集准确率：   99.98%，测试集准确率：   83.55%，Time:12.31324577331543s
              precision    recall  f1-score   support

           0       0.82      0.94      0.88     12435
           1       0.65      0.33      0.44      3846

    accuracy                           0.80     16281
   macro avg       0.74      0.64      0.66     16281
weighted avg       0.78      0.80      0.77     16281

              precision    recall  f1-score   support

           0       0.86      0.89      0.88     12435
           1       0.61      0.55      0.58      3846

    accuracy                           0.81     16281
   macro avg       0.74      0.72      0.73     16281
weighted avg       0.80      0.81      0.81     16281

              precision    recall  f1-score   support

           0       0.80      0.94      0.87     12435
           1       0.57      0.25      0.35      3846

    accuracy                           0.78     16281
   macro avg       0.68      0.60      0.61     16281
weighted avg       0.75      0.78      0.74     16281

              precision    recall  f1-score   support

           0       0.80      0.97      0.88     12435
           1       0.69      0.23      0.34      3846

    accuracy                           0.79     16281
   macro avg       0.75      0.60      0.61     16281
weighted avg       0.78      0.79      0.75     16281

              precision    recall  f1-score   support

           0       0.87      0.93      0.90     12435
           1       0.70      0.54      0.61      3846

    accuracy                           0.84     16281
   macro avg       0.78      0.73      0.75     16281
weighted avg       0.83      0.84      0.83     16281</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/27/数据挖掘实战01-居民收入分类-模型训练/" data-id="cjykykdpf0002isvjbdlvqddn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/07/26/First-test/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">First test</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/27/数据挖掘实战01-居民收入分类-模型训练/">数据挖掘实战01-居民收入分类 模型训练</a>
          </li>
        
          <li>
            <a href="/2019/07/26/First-test/">First test</a>
          </li>
        
          <li>
            <a href="/2019/07/26/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>